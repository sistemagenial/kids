import{u as Ze,a as et,r as o,j as e}from"./index-DkWMjuHb.js";import{C as _}from"./Card-CpNQlLbP.js";import{B as l}from"./Button-B4k9wJs-.js";import{I as b}from"./Input-DWPq2EuO.js";import{H as tt}from"./Header-DPb4Nwfq.js";function nt(){const F=Ze(),{success:u,error:n}=et(),[U,ye]=o.useState("users"),[_e,Se]=o.useState([]),[ne,Ce]=o.useState([]),[ie,ke]=o.useState([]),[Ee,Te]=o.useState([]),[Oe,ce]=o.useState(!0),[Pe,De]=o.useState(null),[c,I]=o.useState(null),[y,L]=o.useState([]),[A,Fe]=o.useState(""),[de,Ue]=o.useState("all"),[T,Le]=o.useState("name"),[O,me]=o.useState("asc"),[p,P]=o.useState(null),[C,$]=o.useState([]),[xe,Ae]=o.useState(""),[he,Re]=o.useState("all"),[d,f]=o.useState({title:"",content:"",image_url:"",pdf_url:"",order_number:1,is_new:!0,testament:"old"}),[g,D]=o.useState(null),[k,M]=o.useState([]),[pe,Ve]=o.useState(""),[ue,Ie]=o.useState("all"),[m,j]=o.useState({title:"",description:"",video_url:"",thumbnail_url:"",order_number:1,is_new:!0,testament:"old"}),[N,R]=o.useState(null),[E,H]=o.useState([]),[B,$e]=o.useState(""),[ge,Me]=o.useState("all"),[x,w]=o.useState({name:"",email:"",cpf:"",whatsapp:"",plan:"basic",status:"pending",notes:""}),[h,S]=o.useState({name:"",email:"",cpf:"",whatsapp:"",license_count:1,access_expires_at:""}),[He,Q]=o.useState(!1),[v,z]=o.useState({currentPassword:"",newPassword:"",confirmPassword:""});o.useEffect(()=>{const t=localStorage.getItem("user");if(!t){F("/login");return}try{const s=JSON.parse(t),r={...s,is_admin:Number(s.is_admin)===1};r.is_admin?(De(r),be()):F("/inicio")}catch{F("/login")}},[F]);const be=async()=>{ce(!0);try{await Promise.all([V(),Y(),Z(),J()])}catch(t){console.error(t),n("Erro","Não foi possível carregar os dados.")}finally{ce(!1)}},V=async()=>{try{const s=await(await fetch("/api/users.php?action=all")).json();if(s.data){const r=s.data.map(a=>({...a,id:String(a.id),license_count:Number(a.license_count),is_admin:Number(a.is_admin)===1}));Se(r)}}catch(t){console.error(t)}},Y=async()=>{try{const s=await(await fetch("/api/stories.php?action=all")).json();if(s.data){const r=s.data.map(a=>({...a,order_number:Number(a.order_number),is_new:!!a.is_new,id:String(a.id)}));Ce(r)}}catch(t){console.error(t)}},Z=async()=>{try{const s=await(await fetch("/api/videos.php?action=all")).json();if(s.data){const r=s.data.map(a=>({...a,order_number:Number(a.order_number),is_new:!!a.is_new,id:String(a.id)}));ke(r)}}catch(t){console.error("Erro ao buscar vídeos:",t)}},J=async()=>{try{const s=await(await fetch("/api/orders.php?action=all")).json();if(s.data){const r=s.data.map(a=>({...a,id:String(a.id)}));Te(r)}}catch(t){console.error("Erro ao buscar pedidos:",t)}},q=t=>{switch(t){case 1:return"BÁSICO";case 3:return"PRO";case 5:return"PREMIUM";default:return"BÁSICO"}},G=t=>{const s=new Date,r=new Date(t);return Math.ceil((r.getTime()-s.getTime())/(1e3*60*60*24))},Be=t=>t<=0?"bg-red-100 text-red-800":t<=30?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",ze=t=>t<=0?"Expirado":t<=30?"Expirando":"Ativo",Je=t=>{L(s=>s.includes(t)?s.filter(r=>r!==t):[...s,t])},W=t=>{T===t?me(s=>s==="asc"?"desc":"asc"):(Le(t),me("asc"))},ee=()=>{let t=_e.filter(s=>{if(!(s.name.toLowerCase().includes(A.toLowerCase())||s.email.toLowerCase().includes(A.toLowerCase())||(s.cpf||"").includes(A)||q(s.license_count).toLowerCase().includes(A.toLowerCase())))return!1;const a=G(s.access_expires_at);switch(de){case"active":return a>30&&!s.is_admin;case"expiring":return a>0&&a<=30&&!s.is_admin;case"expired":return a<=0&&!s.is_admin;case"basic":return s.license_count===1;case"pro":return s.license_count===3;case"premium":return s.license_count===5;default:return!0}});return t.sort((s,r)=>{let a,i;switch(T){case"name":a=s.name.toLowerCase(),i=r.name.toLowerCase();break;case"email":a=s.email.toLowerCase(),i=r.email.toLowerCase();break;case"plan":a=q(s.license_count),i=q(r.license_count);break;case"days":a=G(s.access_expires_at),i=G(r.access_expires_at);break;default:a="",i=""}return a<i?O==="asc"?-1:1:a>i?O==="asc"?1:-1:0}),t},qe=t=>{I(t),S({name:t.name,email:t.email,cpf:t.cpf||"",whatsapp:t.whatsapp||"",license_count:t.license_count,access_expires_at:t.access_expires_at})},fe=()=>{S({name:"",email:"",cpf:"",whatsapp:"",license_count:1,access_expires_at:""})},je=()=>{I(null),fe()},Ge=async()=>{try{const t=c?"/api/users.php?action=update":"/api/users.php?action=create",s=c?"PUT":"POST",r=c?{...h,id:c.id}:h,a=await fetch(t,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(a.ok)u("Sucesso",c?"Usuário atualizado!":"Usuário criado!"),I(null),fe(),V();else{const i=await a.json();n("Erro",i.error||"Falha ao salvar usuário")}}catch(t){console.error(t),n("Erro","Falha ao salvar usuário")}},Ne=async t=>{try{const s=await fetch(`/api/users.php?action=delete&id=${t}`,{method:"DELETE"});if(s.ok)u("Sucesso","Usuário excluído!"),V();else{const r=await s.json();n("Erro",r.error||"Falha ao excluir usuário")}}catch(s){console.error(s),n("Erro","Falha ao excluir usuário")}},we=async t=>{try{const s=await fetch("/api/users.php?action=update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,access_expires_at:"renew"})});if(s.ok)u("Sucesso","Usuário renovado por 1 ano!"),V();else{const r=await s.json();n("Erro",r.error||"Falha ao renovar")}}catch(s){console.error(s),n("Erro","Falha ao renovar usuário")}},We=t=>{$(s=>s.includes(t)?s.filter(r=>r!==t):[...s,t])},te=()=>{f({title:"",content:"",image_url:"",pdf_url:"",order_number:ne.length+1,is_new:!0,testament:"old"})},se=()=>ne.filter(t=>{if(!t.title.toLowerCase().includes(xe.toLowerCase()))return!1;switch(he){case"old":return t.testament==="old";case"new":return t.testament==="new";case"novidades":return t.is_new;default:return!0}}).sort((t,s)=>t.order_number-s.order_number),ae=async t=>{try{const s=await fetch(`/api/stories.php?action=delete&id=${t}`,{method:"DELETE"});if(s.ok)u("Sucesso","História excluída!"),Y();else{const r=await s.json();n("Erro",r.error||"Falha ao excluir história")}}catch(s){console.error(s),n("Erro","Falha ao excluir história")}},Xe=t=>{M(s=>s.includes(t)?s.filter(r=>r!==t):[...s,t])},re=()=>{j({title:"",description:"",video_url:"",thumbnail_url:"",order_number:ie.length+1,is_new:!0,testament:"old"})},X=()=>ie.filter(t=>{if(!t.title.toLowerCase().includes(pe.toLowerCase()))return!1;switch(ue){case"old":return t.testament==="old";case"new":return t.testament==="new";case"novidades":return t.is_new;default:return!0}}).sort((t,s)=>t.order_number-s.order_number),le=async t=>{try{const s=await fetch(`/api/videos.php?action=delete&id=${t}`,{method:"DELETE"});if(s.ok)u("Sucesso","Vídeo excluído!"),Z();else{const r=await s.json();n("Erro",r.error||"Falha ao excluir vídeo")}}catch(s){console.error(s),n("Erro","Falha ao excluir vídeo")}},Ke=t=>{H(s=>s.includes(t)?s.filter(r=>r!==t):[...s,t])},oe=()=>{w({name:"",email:"",cpf:"",whatsapp:"",plan:"basic",status:"pending",notes:""})},K=()=>Ee.filter(t=>{if(!(t.name.toLowerCase().includes(B.toLowerCase())||t.email.toLowerCase().includes(B.toLowerCase())||(t.cpf||"").includes(B)))return!1;switch(ge){case"pending":return t.status==="pending";case"paid":return t.status==="paid";case"user_created":return t.status==="user_created";default:return!0}}).sort((t,s)=>new Date(s.created_at).getTime()-new Date(t.created_at).getTime()),Qe=()=>{localStorage.removeItem("user"),F("/login")},Ye=async()=>{if(v.newPassword!==v.confirmPassword){n("Erro","As senhas não coincidem");return}try{const t=await fetch("/api/users.php?action=change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:v.currentPassword,newPassword:v.newPassword})});if(t.ok)u("Sucesso","Senha alterada!"),Q(!1),z({currentPassword:"",newPassword:"",confirmPassword:""});else{const s=await t.json();n("Erro",s.error||"Falha ao alterar senha")}}catch(t){console.error(t),n("Erro","Falha ao alterar senha")}};return Oe?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:e.jsx("div",{className:"loading-spinner"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 animate-gradient",children:[e.jsx(tt,{user:Pe,onLogout:Qe}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Painel Administrativo"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie usuários, histórias, vídeos e pedidos"})]}),e.jsxs(l,{onClick:()=>Q(!0),className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold px-4 py-2",children:[e.jsx("i",{className:"ri-lock-line mr-2"}),"Alterar Senha"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-8",children:[{id:"users",label:"Usuários",icon:"ri-user-line",colors:"from-blue-500 to-blue-6"},{id:"stories",label:"Histórias",icon:"ri-book-line",colors:"from-green-500 to-green-6"},{id:"videos",label:"Vídeos",icon:"ri-video-line",colors:"from-red-500 to-red-6"},{id:"orders",label:"Pedidos",icon:"ri-shopping-cart-line",colors:"from-purple-500 to-purple-6"}].map(t=>e.jsxs(l,{onClick:()=>ye(t.id),className:`font-bold px-6 py-3 ${U===t.id?`bg-gradient-to-r ${t.colors} text-white shadow-lg`:"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}`,children:[e.jsx("i",{className:`${t.icon} mr-2`}),t.label]},t.id))}),e.jsxs("div",{className:"flex gap-4 mb-8",children:[e.jsxs(l,{onClick:async()=>{try{const t=await fetch("/api/backup.php?action=create",{method:"POST"});if(t.ok){const s=await t.blob(),r=window.URL.createObjectURL(s),a=document.createElement("a");a.href=r,a.download=`backup-${new Date().toISOString().split("T")[0]}.sql`,document.body.appendChild(a),a.click(),a.remove(),window.URL.revokeObjectURL(r),u("Sucesso","Backup criado e baixado.")}else n("Erro","Falha ao criar backup")}catch(t){console.error(t),n("Erro","Falha ao criar backup")}},className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold px-4 py-2",children:[e.jsx("i",{className:"ri-download-cloud-line mr-2"}),"Fazer Backup"]}),e.jsxs(l,{onClick:()=>{const t=document.createElement("input");t.type="file",t.accept=".sql",t.onchange=async s=>{var i;const r=(i=s.target.files)==null?void 0:i[0];if(!r)return;const a=new FormData;a.append("backup",r);try{(await fetch("/api/backup.php?action=restore",{method:"POST",body:a})).ok?(u("Sucesso","Backup restaurado."),be()):n("Erro","Falha ao restaurar backup")}catch(ve){console.error(ve),n("Erro","Falha ao restaurar backup")}},t.click()},className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold px-4 py-2",children:[e.jsx("i",{className:"ri-upload-cloud-line mr-2"}),"Restaurar Backup"]})]}),U==="users"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(_,{className:"p-6 bg-white/80 backdrop-blur-sm border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Lista de Usuários"}),e.jsxs(l,{onClick:je,className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold px-4 py-2",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Criar Usuário"]})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 min-w-64",children:[e.jsx("input",{type:"text",placeholder:"Pesquisar por nome, email, CPF ou plano...",value:A,onChange:t=>Fe(t.target.value),className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none transition-all text-sm bg-white shadow-lg"}),e.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]}),e.jsxs("select",{value:de,onChange:t=>Ue(t.target.value),className:"appearance-none bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-bold px-6 py-3 pr-10 rounded-xl shadow-lg",children:[e.jsx("option",{value:"all",className:"bg-white text-gray-800",children:"TODOS"}),e.jsx("option",{value:"active",className:"bg-white text-gray-800",children:"ATIVOS"}),e.jsx("option",{value:"expiring",className:"bg-white text-gray-800",children:"EXPIRANDO"}),e.jsx("option",{value:"expired",className:"bg-white text-gray-800",children:"EXPIRADO"}),e.jsx("option",{value:"basic",className:"bg-white text-gray-800",children:"BÁSICO"}),e.jsx("option",{value:"pro",className:"bg-white text-gray-800",children:"PRO"}),e.jsx("option",{value:"premium",className:"bg-white text-gray-800",children:"PREMIUM"})]})]}),y.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg border border-blue-200 flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-800",children:[y.length," usuário(s) selecionado(s)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{onClick:async()=>{if(window.confirm(`Excluir ${y.length} usuários?`)){for(const t of y)await Ne(t);L([])}},className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold px-3 py-1 text-sm",children:[e.jsx("i",{className:"ri-delete-bin-line mr-1"}),"Excluir"]}),e.jsxs(l,{onClick:async()=>{if(window.confirm(`Renovar ${y.length} usuários por 1 ano?`)){for(const t of y)await we(t);L([])}},className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold px-3 py-1 text-sm",children:[e.jsx("i",{className:"ri-refresh-line mr-1"}),"Renovar"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"p-2",children:e.jsx("input",{type:"checkbox",checked:y.length>0&&y.length===ee().filter(t=>!t.is_admin).length,onChange:t=>{t.target.checked?L(ee().filter(s=>!s.is_admin).map(s=>s.id)):L([])},className:"rounded"})}),e.jsxs("th",{className:"p-2 cursor-pointer",onClick:()=>W("name"),children:["Nome ",T==="name"&&e.jsx("i",{className:`ri-arrow-${O==="asc"?"up":"down"}-line ml-1`})]}),e.jsxs("th",{className:"p-2 cursor-pointer",onClick:()=>W("email"),children:["Email ",T==="email"&&e.jsx("i",{className:`ri-arrow-${O==="asc"?"up":"down"}-line ml-1`})]}),e.jsxs("th",{className:"p-2 cursor-pointer",onClick:()=>W("plan"),children:["Plano ",T==="plan"&&e.jsx("i",{className:`ri-arrow-${O==="asc"?"up":"down"}-line ml-1`})]}),e.jsxs("th",{className:"p-2 cursor-pointer",onClick:()=>W("days"),children:["Dias Restantes ",T==="days"&&e.jsx("i",{className:`ri-arrow-${O==="asc"?"up":"down"}-line ml-1`})]}),e.jsx("th",{className:"p-2",children:"Status"})]})}),e.jsx("tbody",{children:ee().map(t=>{const s=t.is_admin?999999:G(t.access_expires_at);return e.jsxs("tr",{className:`border-b border-gray-100 hover:bg-gray-50 cursor-pointer ${(c==null?void 0:c.id)===t.id?"bg-blue-50":""} ${t.is_admin?"bg-yellow-50":""}`,onClick:()=>qe(t),children:[e.jsx("td",{className:"p-2 text-center",children:t.is_admin?e.jsx("i",{className:"ri-vip-crown-fill text-yellow-500 text-xl"}):e.jsx("input",{type:"checkbox",checked:y.includes(t.id),onChange:r=>{r.stopPropagation(),Je(t.id)},className:"rounded"})}),e.jsxs("td",{className:"p-2 text-center font-medium text-gray-800",children:[t.name,t.is_admin&&e.jsx("span",{className:"ml-2 text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"ADMIN"})]}),e.jsx("td",{className:"p-2 text-center text-gray-600",children:t.email}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:q(t.license_count)})}),e.jsx("td",{className:"p-2 text-center font-bold",children:t.is_admin?e.jsx("span",{className:"text-yellow-600",children:"∞"}):e.jsx("span",{className:s<=0?"text-red-600":s<=30?"text-yellow-600":"text-green-600",children:s})}),e.jsx("td",{className:"p-2 text-center",children:t.is_admin?e.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"Admin"}):e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Be(s)}`,children:ze(s)})})]},t.id)})})]})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(_,{className:"p-6 bg-white/80 backdrop-blur-sm border border-white/20 sticky top-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:c?"Editar Usuário":"Criar Usuário"}),e.jsxs(l,{onClick:je,className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold px-3 py-2 text-sm",children:[e.jsx("i",{className:"ri-add-line mr-1"}),"Novo"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nome"}),e.jsx(b,{id:"name",value:h.name,onChange:t=>S({...h,name:t.target.value}),placeholder:"Nome completo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx(b,{id:"email",type:"email",value:h.email,onChange:t=>S({...h,email:t.target.value}),placeholder:"email@exemplo.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CPF"}),e.jsx(b,{id:"cpf",value:h.cpf,onChange:t=>S({...h,cpf:t.target.value}),placeholder:"000.000.000-00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp"}),e.jsx(b,{id:"whatsapp",value:h.whatsapp,onChange:t=>S({...h,whatsapp:t.target.value}),placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plano"}),e.jsxs("select",{value:h.license_count,onChange:t=>S({...h,license_count:Number(t.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded",children:[e.jsx("option",{value:1,children:"BÁSICO (1 dispositivo)"}),e.jsx("option",{value:3,children:"PRO (3 dispositivos)"}),e.jsx("option",{value:5,children:"PREMIUM (5 dispositivos)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Data de Expiração"}),e.jsx(b,{type:"datetime-local",value:h.access_expires_at?new Date(h.access_expires_at).toISOString().slice(0,16):"",onChange:t=>S({...h,access_expires_at:t.target.value})})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(l,{onClick:Ge,className:"flex-1 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-bold py-2",children:[e.jsx("i",{className:"ri-save-line mr-2"}),c?"Salvar Alterações":"Criar Usuário"]}),c&&!c.is_admin&&e.jsx(l,{onClick:()=>{window.confirm("Excluir este usuário?")&&(Ne(c.id),I(null))},className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold px-4 py-2",children:e.jsx("i",{className:"ri-delete-bin-line"})})]}),c&&!c.is_admin&&e.jsxs(l,{onClick:()=>{window.confirm("Renovar usuário por 1 ano?")&&we(c.id)},className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-2",children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Renovar 1 Ano"]})]})]})})]}),U==="stories"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(_,{className:"p-6 bg-white/80 backdrop-blur-sm border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Lista de Histórias"}),e.jsxs(l,{onClick:()=>{P(null),te()},className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold px-4 py-2",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Criar História"]})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 min-w-64",children:[e.jsx("input",{type:"text",placeholder:"Pesquisar histórias...",value:xe,onChange:t=>Ae(t.target.value),className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:border-green-500 focus:outline-none transition-all text-sm bg-white shadow-lg"}),e.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]}),e.jsxs("select",{value:he,onChange:t=>Re(t.target.value),className:"appearance-none bg-gradient-to-r from-green-500 to-emerald-600 text-white font-bold px-6 py-3 pr-10 rounded-xl shadow-lg",children:[e.jsx("option",{value:"all",className:"bg-white text-gray-800",children:"TODOS"}),e.jsx("option",{value:"new",className:"bg-white text-gray-800",children:"NOVO TESTAMENTO"}),e.jsx("option",{value:"old",className:"bg-white text-gray-800",children:"VELHO TESTAMENTO"}),e.jsx("option",{value:"novidades",className:"bg-white text-gray-800",children:"NOVIDADES"})]})]}),C.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-green-50 rounded-lg border border-green-200 flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium text-green-800",children:[C.length," história(s) selecionada(s)"]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(l,{onClick:async()=>{if(window.confirm(`Excluir ${C.length} histórias?`)){for(const t of C)await ae(t);$([])}},className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold px-3 py-1 text-sm",children:[e.jsx("i",{className:"ri-delete-bin-line mr-1"}),"Excluir"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"p-2 text-center",children:e.jsx("input",{type:"checkbox",checked:C.length>0&&C.length===se().length,onChange:t=>{t.target.checked?$(se().map(s=>s.id)):$([])},className:"rounded"})}),e.jsx("th",{className:"p-2 text-center",children:"Ordem"}),e.jsx("th",{className:"p-2 text-center",children:"Título"}),e.jsx("th",{className:"p-2 text-center",children:"Status"}),e.jsx("th",{className:"p-2 text-center",children:"Criado"}),e.jsx("th",{className:"p-2 text-center",children:"Imagem"}),e.jsx("th",{className:"p-2 text-center",children:"Ações"})]})}),e.jsx("tbody",{children:se().map(t=>e.jsxs("tr",{className:`border-b border-gray-100 hover:bg-gray-50 cursor-pointer ${(p==null?void 0:p.id)===t.id?"bg-green-50":""}`,onClick:()=>{P(t),f({title:t.title,content:t.content,image_url:t.image_url||"",pdf_url:t.pdf_url||"",order_number:t.order_number,is_new:t.is_new||!1,testament:t.testament||"old"})},children:[e.jsx("td",{className:"p-2 text-center",children:e.jsx("input",{type:"checkbox",checked:C.includes(t.id),onChange:()=>We(t.id),onClick:s=>s.stopPropagation(),className:"rounded"})}),e.jsx("td",{className:"p-2 text-center font-bold text-blue-600",children:t.order_number}),e.jsx("td",{className:"p-2 text-center font-medium text-gray-800",children:t.title}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.is_new?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.is_new?"Novo":"Antigo"})}),e.jsx("td",{className:"p-2 text-center text-gray-600",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-2 text-center",children:t.image_url?e.jsx("img",{src:t.image_url,alt:t.title,className:"h-12 w-12 object-cover rounded"}):e.jsx("span",{className:"text-gray-400",children:"Sem imagem"})}),e.jsxs("td",{className:"p-2 text-center",children:[e.jsx(l,{onClick:s=>{s.stopPropagation(),P(t),f({title:t.title,content:t.content,image_url:t.image_url||"",pdf_url:t.pdf_url||"",order_number:t.order_number,is_new:t.is_new||!1,testament:t.testament||"old"})},className:"bg-gradient-to-r from-indigo-500 to-indigo-600 hover:from-indigo-600 hover:to-indigo-700 text-white font-bold px-2 py-1 text-sm",children:e.jsx("i",{className:"ri-edit-line"})}),e.jsx(l,{onClick:s=>{s.stopPropagation(),window.confirm("Excluir história?")&&ae(t.id)},className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold px-2 py-1 text-sm ml-2",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})]},t.id))})]})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(_,{className:"p-6 bg-white/80 backdrop-blur-sm border border-white/20 sticky top-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:p?"Editar História":"Criar História"}),e.jsxs(l,{onClick:()=>{P(null),te()},className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold px-3 py-2 text-sm",children:[e.jsx("i",{className:"ri-add-line mr-1"}),"Novo"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Testamento"}),e.jsxs("select",{value:d.testament,onChange:t=>f({...d,testament:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded",children:[e.jsx("option",{value:"old",children:"VELHO TESTAMENTO"}),e.jsx("option",{value:"new",children:"NOVO TESTAMENTO"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Título"}),e.jsx(b,{id:"title",value:d.title,onChange:t=>f({...d,title:t.target.value}),placeholder:"Título da história"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Conteúdo"}),e.jsx("textarea",{value:d.content,onChange:t=>f({...d,content:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded",rows:8,placeholder:"Conteúdo em HTML"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Imagem URL"}),e.jsx(b,{id:"image_url",value:d.image_url,onChange:t=>f({...d,image_url:t.target.value}),placeholder:"https://exemplo.com/imagem.jpg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"PDF URL"}),e.jsx(b,{id:"pdf_url",value:d.pdf_url,onChange:t=>f({...d,pdf_url:t.target.value}),placeholder:"https://exemplo.com/historia.pdf"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Link do arquivo PDF para download da história"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ordem"}),e.jsx(b,{type:"number",id:"order_number",value:d.order_number,onChange:t=>f({...d,order_number:Number(t.target.value)}),min:1})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_new",checked:d.is_new,onChange:t=>f({...d,is_new:t.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"is_new",className:"ml-2 text-sm font-medium text-gray-700",children:"Marcar como Novidade?"})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(l,{onClick:async()=>{try{const t=p?`/api/stories.php?action=update&id=${p.id}`:"/api/stories.php?action=create",s=p?"PUT":"POST",r=p?{...d,id:p.id}:d,a=await fetch(t,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(a.ok)u("Sucesso",p?"História atualizada!":"História criada!"),P(null),te(),await Y();else{const i=await a.json();n("Erro",i.error||"Falha ao salvar história")}}catch(t){console.error(t),n("Erro","Falha ao salvar história")}},className:"flex-1 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold py-2",children:[e.jsx("i",{className:"ri-save-line mr-2"}),p?"Salvar Alterações":"Criar História"]}),p&&e.jsx(l,{onClick:()=>{window.confirm("Excluir esta história?")&&(ae(p.id),P(null))},className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold px-4 py-2",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})]})]})})]}),U==="videos"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(_,{className:"p-6 bg-white/80 backdrop-blur-sm border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Lista de Vídeos"}),e.jsxs(l,{onClick:()=>{D(null),re()},className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold px-4 py-2",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Criar Vídeo"]})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 min-w-64",children:[e.jsx("input",{type:"text",placeholder:"Pesquisar vídeos...",value:pe,onChange:t=>Ve(t.target.value),className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:border-red-500 focus:outline-none transition-all text-sm bg-white shadow-lg"}),e.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]}),e.jsxs("select",{value:ue,onChange:t=>Ie(t.target.value),className:"appearance-none bg-gradient-to-r from-red-500 to-red-600 text-white font-bold px-6 py-3 pr-10 rounded-xl shadow-lg",children:[e.jsx("option",{value:"all",className:"bg-white text-gray-800",children:"TODOS"}),e.jsx("option",{value:"new",className:"bg-white text-gray-800",children:"NOVO TESTAMENTO"}),e.jsx("option",{value:"old",className:"bg-white text-gray-800",children:"VELHO TESTAMENTO"}),e.jsx("option",{value:"novidades",className:"bg-white text-gray-800",children:"NOVIDADES"})]})]}),k.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 rounded-lg border border-red-200 flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium text-red-800",children:[k.length," vídeo(s) selecionado(s)"]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(l,{onClick:async()=>{if(window.confirm(`Excluir ${k.length} vídeos?`)){for(const t of k)await le(t);M([])}},className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold px-3 py-1 text-sm",children:[e.jsx("i",{className:"ri-delete-bin-line mr-1"}),"Excluir"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"p-2 text-center",children:e.jsx("input",{type:"checkbox",checked:k.length>0&&k.length===X().length,onChange:t=>{t.target.checked?M(X().map(s=>s.id)):M([])},className:"rounded"})}),e.jsx("th",{className:"p-2 text-center",children:"Ordem"}),e.jsx("th",{className:"p-2 text-center",children:"Título"}),e.jsx("th",{className:"p-2 text-center",children:"Status"}),e.jsx("th",{className:"p-2 text-center",children:"Criado"}),e.jsx("th",{className:"p-2 text-center",children:"Thumbnail"}),e.jsx("th",{className:"p-2 text-center",children:"Ações"})]})}),e.jsx("tbody",{children:X().length===0?e.jsx("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:e.jsx("td",{className:"p-2 text-center",colSpan:7,children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("i",{className:"ri-video-line text-4xl text-gray-400 mb-2"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum vídeo encontrado"})]})})}):X().map(t=>e.jsxs("tr",{className:`border-b border-gray-100 hover:bg-gray-50 cursor-pointer ${(g==null?void 0:g.id)===t.id?"bg-red-50":""}`,onClick:()=>{D(t),j({title:t.title,description:t.description,video_url:t.video_url,thumbnail_url:t.thumbnail_url||"",order_number:t.order_number,is_new:t.is_new||!1,testament:t.testament||"old"})},children:[e.jsx("td",{className:"p-2 text-center",children:e.jsx("input",{type:"checkbox",checked:k.includes(t.id),onChange:()=>Xe(t.id),onClick:s=>s.stopPropagation(),className:"rounded"})}),e.jsx("td",{className:"p-2 text-center font-bold text-blue-600",children:t.order_number}),e.jsx("td",{className:"p-2 text-center font-medium text-gray-800",children:t.title}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.is_new?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.is_new?"Novo":"Antigo"})}),e.jsx("td",{className:"p-2 text-center text-gray-600",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-2 text-center",children:t.thumbnail_url?e.jsx("img",{src:t.thumbnail_url,alt:t.title,className:"h-12 w-12 object-cover rounded"}):e.jsx("span",{className:"text-gray-400",children:"Sem thumbnail"})}),e.jsxs("td",{className:"p-2 text-center",children:[e.jsx(l,{onClick:s=>{s.stopPropagation(),D(t),j({title:t.title,description:t.description,video_url:t.video_url,thumbnail_url:t.thumbnail_url||"",order_number:t.order_number,is_new:t.is_new||!1,testament:t.testament||"old"})},className:"bg-gradient-to-r from-indigo-500 to-indigo-600 hover:from-indigo-600 hover:to-indigo-700 text-white font-bold px-2 py-1 text-sm",children:e.jsx("i",{className:"ri-edit-line"})}),e.jsx(l,{onClick:s=>{s.stopPropagation(),window.confirm("Excluir vídeo?")&&le(t.id)},className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold px-2 py-1 text-sm ml-2",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})]},t.id))})]})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(_,{className:"p-6 bg-white/80 backdrop-blur-sm border border-white/20 sticky top-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:g?"Editar Vídeo":"Criar Vídeo"}),e.jsxs(l,{onClick:()=>{D(null),re()},className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold px-3 py-2 text-sm",children:[e.jsx("i",{className:"ri-add-line mr-1"}),"Novo"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Testamento"}),e.jsxs("select",{value:m.testament,onChange:t=>j({...m,testament:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded",children:[e.jsx("option",{value:"old",className:"bg-white text-gray-800",children:"VELHO TESTAMENTO"}),e.jsx("option",{value:"new",className:"bg-white text-gray-800",children:"NOVO TESTAMENTO"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Título"}),e.jsx("input",{type:"text",placeholder:"Título do vídeo",value:m.title,onChange:t=>j({...m,title:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Descrição"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded",rows:4,placeholder:"Descrição do vídeo",value:m.description,onChange:t=>j({...m,description:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"URL do Vídeo"}),e.jsx("input",{type:"url",placeholder:"https://youtube.com/watch?v=...",value:m.video_url,onChange:t=>j({...m,video_url:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Thumbnail URL"}),e.jsx("input",{type:"url",placeholder:"https://exemplo.com/thumbnail.jpg",value:m.thumbnail_url,onChange:t=>j({...m,thumbnail_url:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ordem"}),e.jsx("input",{type:"number",min:1,value:m.order_number,onChange:t=>j({...m,order_number:Number(t.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_new_video",checked:m.is_new,onChange:t=>j({...m,is_new:t.target.checked}),className:"rounded"}),e.jsx("label",{htmlFor:"is_new_video",className:"ml-2 text-sm font-medium text-gray-700",children:"Marcar como Novidade?"})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs(l,{onClick:async()=>{try{const t=g?"/api/videos.php?action=update":"/api/videos.php?action=create",s=g?"PUT":"POST",r=g?{...m,id:g.id}:m,a=await fetch(t,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(a.ok)u("Sucesso",g?"Vídeo atualizado!":"Vídeo criado!"),D(null),re(),await Z();else{const i=await a.json();n("Erro",i.error||"Falha ao salvar vídeo")}}catch(t){console.error(t),n("Erro","Falha ao salvar vídeo")}},className:"flex-1 bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold py-2",children:[e.jsx("i",{className:"ri-save-line mr-2"}),g?"Salvar Alterações":"Criar Vídeo"]}),g&&e.jsx(l,{onClick:()=>{window.confirm("Excluir este vídeo?")&&(le(g.id),D(null))},className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-bold px-4 py-2",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})]})]})})]}),U==="orders"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(_,{className:"p-6 bg-white/80 backdrop-blur-sm border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Lista de Pedidos"}),e.jsxs(l,{onClick:()=>{R(null),oe()},className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold px-4 py-2",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Novo Pedido"]})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 min-w-64",children:[e.jsx("input",{type:"text",placeholder:"Pesquisar pedidos...",value:B,onChange:t=>$e(t.target.value),className:"w-full pl-10 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 focus:outline-none transition-all text-sm bg-white shadow-lg"}),e.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]}),e.jsxs("select",{value:ge,onChange:t=>Me(t.target.value),className:"appearance-none bg-gradient-to-r from-purple-500 to-purple-600 text-white font-bold px-6 py-3 pr-10 rounded-xl shadow-lg",children:[e.jsx("option",{value:"all",className:"bg-white text-gray-800",children:"TODOS"}),e.jsx("option",{value:"pending",className:"bg-white text-gray-800",children:"PENDENTE"}),e.jsx("option",{value:"paid",className:"bg-white text-gray-800",children:"PAGO"}),e.jsx("option",{value:"user_created",className:"bg-white text-gray-800",children:"USUÁRIO CRIADO"})]})]}),E.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-purple-50 rounded-lg border border-purple-200 flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm font-medium text-purple-800",children:[E.length," pedido(s) selecionado(s)"]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(l,{onClick:async()=>{if(window.confirm(`Marcar ${E.length} pedidos como PAGO?`)){for(const t of E)try{await fetch("/api/orders.php?action=update-status",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,status:"paid"})})}catch(s){console.error(s)}H([]),J()}},className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold px-3 py-1 text-sm",children:[e.jsx("i",{className:"ri-check-line mr-1"}),"Marcar Pago"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"p-2 text-center",children:e.jsx("input",{type:"checkbox",checked:E.length>0&&E.length===K().length,onChange:t=>{t.target.checked?H(K().map(s=>s.id)):H([])},className:"rounded"})}),e.jsx("th",{className:"p-2 text-center",children:"Nome"}),e.jsx("th",{className:"p-2 text-center",children:"Email"}),e.jsx("th",{className:"p-2 text-center",children:"Plano"}),e.jsx("th",{className:"p-2 text-center",children:"Status"}),e.jsx("th",{className:"p-2 text-center",children:"Data"}),e.jsx("th",{className:"p-2 text-center",children:"Ações"})]})}),e.jsx("tbody",{children:K().length===0?e.jsx("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:e.jsx("td",{className:"p-2 text-center",colSpan:7,children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("i",{className:"ri-shopping-cart-line text-4xl text-gray-400 mb-2"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum pedido encontrado"})]})})}):K().map(t=>{var s;return e.jsxs("tr",{className:`border-b border-gray-100 hover:bg-gray-50 cursor-pointer ${(N==null?void 0:N.id)===t.id?"bg-purple-50":""}`,onClick:()=>{R(t),w({name:t.name,email:t.email,cpf:t.cpf||"",whatsapp:t.whatsapp||"",plan:t.plan,status:t.status,notes:t.notes||""})},children:[e.jsx("td",{className:"p-2 text-center",children:e.jsx("input",{type:"checkbox",checked:E.includes(t.id),onChange:()=>Ke(t.id),onClick:r=>r.stopPropagation(),className:"rounded"})}),e.jsx("td",{className:"p-2 text-center font-medium text-gray-800",children:t.name}),e.jsx("td",{className:"p-2 text-center text-gray-600",children:t.email}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:((s=t.planDetails)==null?void 0:s.name)||t.plan.toUpperCase()})}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.status==="pending"?"bg-yellow-100 text-yellow-800":t.status==="paid"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:t.status==="pending"?"PENDENTE":t.status==="paid"?"PAGO":"USUÁRIO CRIADO"})}),e.jsx("td",{className:"p-2 text-center text-gray-600",children:new Date(t.created_at).toLocaleDateString()}),e.jsxs("td",{className:"p-2 text-center",children:[e.jsx(l,{onClick:r=>{r.stopPropagation(),R(t),w({name:t.name,email:t.email,cpf:t.cpf||"",whatsapp:t.whatsapp||"",plan:t.plan,status:t.status,notes:t.notes||""})},className:"bg-gradient-to-r from-indigo-500 to-indigo-600 hover:from-indigo-600 hover:to-indigo-700 text-white font-bold px-2 py-1 text-sm",children:e.jsx("i",{className:"ri-edit-line"})}),t.status==="paid"&&e.jsx(l,{onClick:async r=>{if(r.stopPropagation(),window.confirm("Criar usuário a partir deste pedido?"))try{const a=await fetch("/api/orders.php?action=create-user-from-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({order_id:t.id})});if(a.ok)u("Sucesso","Usuário criado com sucesso!"),J(),V();else{const i=await a.json();n("Erro",i.error||"Falha ao criar usuário")}}catch(a){console.error(a),n("Erro","Falha ao criar usuário")}},className:`bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-7

text-white font-bold px-2 py-1 text-sm ml-2`,children:e.jsx("i",{className:"ri-user-add-line"})})]})]},t.id)})})]})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(_,{className:"p-6 bg-white/80 backdrop-blur-sm border border-white/20 sticky top-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:N?"Detalhes do Pedido":"Novo Pedido"}),e.jsxs(l,{onClick:()=>{R(null),oe()},className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold px-3 py-2 text-sm",children:[e.jsx("i",{className:"ri-add-line mr-1"}),"Novo"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nome"}),e.jsx("input",{type:"text",placeholder:"Nome completo",value:x.name,onChange:t=>w({...x,name:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",placeholder:"email@exemplo.com",value:x.email,onChange:t=>w({...x,email:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CPF"}),e.jsx("input",{type:"text",placeholder:"000.000.000-00",value:x.cpf,onChange:t=>w({...x,cpf:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"WhatsApp"}),e.jsx("input",{type:"text",placeholder:"(00) 00000-0000",value:x.whatsapp,onChange:t=>w({...x,whatsapp:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Plano"}),e.jsxs("select",{value:x.plan,onChange:t=>w({...x,plan:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded",children:[e.jsx("option",{value:"basic",className:"bg-white text-gray-800",children:"BÁSICO (1 dispositivo)"}),e.jsx("option",{value:"pro",className:"bg-white text-gray-800",children:"PRO (3 dispositivos)"}),e.jsx("option",{value:"premium",className:"bg-white text-gray-800",children:"PREMIUM (5 dispositivos)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:x.status,onChange:t=>w({...x,status:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded",children:[e.jsx("option",{value:"pending",className:"bg-white text-gray-800",children:"PENDENTE"}),e.jsx("option",{value:"paid",className:"bg-white text-gray-800",children:"PAGO"}),e.jsx("option",{value:"user_created",className:"bg-white text-gray-800",children:"USUÁRIO CRIADO"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Observações"}),e.jsx("textarea",{placeholder:"Observações sobre o pedido...",value:x.notes,onChange:t=>w({...x,notes:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded",rows:3})]}),e.jsx("div",{className:"flex gap-2 pt-4",children:e.jsxs(l,{onClick:async()=>{try{const t=N?"/api/orders.php?action=update-status":"/api/orders.php?action=create",s=N?"PUT":"POST",r=N?{...x,id:N.id}:x,a=await fetch(t,{method:s,headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(a.ok)u("Sucesso",N?"Pedido atualizado!":"Pedido criado!"),R(null),oe(),await J();else{const i=await a.json();n("Erro",i.error||"Falha ao salvar pedido")}}catch(t){console.error(t),n("Erro","Falha ao salvar pedido")}},className:"flex-1 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-bold py-2",children:[e.jsx("i",{className:"ri-save-line mr-2"}),N?"Salvar Alterações":"Criar Pedido"]})})]})]})})]}),He&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(_,{className:"bg-white max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Alterar Senha"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Senha Atual"}),e.jsx(b,{type:"password",value:v.currentPassword,onChange:t=>z({...v,currentPassword:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nova Senha"}),e.jsx(b,{type:"password",value:v.newPassword,onChange:t=>z({...v,newPassword:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Confirmar Nova Senha"}),e.jsx(b,{type:"password",value:v.confirmPassword,onChange:t=>z({...v,confirmPassword:t.target.value})})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx(l,{onClick:()=>Q(!1),className:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2",children:"Cancelar"}),e.jsx(l,{onClick:Ye,className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white px-4 py-2",children:"Salvar"})]})]})})]})]})}export{nt as default};
